#!/bin/bash

#exec 2>> errorConfig.log

function help {
	echo -e "\n"
	echo -e "\t\033[34;1mconfigS.sh \e[0m : allows you to choose different profile at login.
	\e[1mOPTIONS\e[0m :
	-h : \tasks for help.
	-i : \tinstalls the daemon.
	-u : \tuninstalls the daemon."
	echo -e "\n"
}


while getopts ":hiu" option
do
	case ${option} in
		h)
			help
		;;
		i)
			#Create the .desktop file
			echo "[Desktop Entry]
			Name=configSession
			Comment=Choose your session configuration.
			Exec=/bin/bash /opt/configSession.sh
			Terminal=true
			Type=Application" > /tmp/configSession.desktop

			#Copy the script to /opt
			sudo cp ./configSession.sh /opt
			#Copy the .desktop in the autostart folder
			sudo cp /tmp/configSession.desktop /etc/xdg/autostart/
			#Copy the wallpapers in the backdrop folder
			sudo cp ./wallpaper/* /usr/share/xfce4/backdrops/
			#Remove the tmp file
			sudo rm /tmp/configSession.desktop
			whiptail --title "Reboot" --yesno "Do you want to reboot now ?" 8 78
			if [ $? -eq 0 ]
			then
				sudo reboot
			fi
		;;
		u)
			#Remove the script from /opt
			sudo rm /opt/configSession.sh
			#Remove the .desktop from the autostart folder
			sudo rm /etc/xdg/autostart/configSession.desktop
			#Remove the wallpappers
			sudo rm /usr/share/xfce4/backdrops/{pro.jpg,cat.jpg,dog.jpg,train.jpg}
		;;
		\?)
			echo "I don't know what to do with [$OPTARG]. Please, ask for help."
			break
		;;
	esac
done

exit 0
